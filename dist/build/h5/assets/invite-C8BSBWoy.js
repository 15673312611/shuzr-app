import{_ as b,a as v,o as k,c as x,b as t,q as h,i as r,t as u,p as C,k as T,u as I,l as M}from"./index-DDlqzt3H.js";import{u as B}from"./services-GkRl5Aq9.js";import{s as p}from"./request-CIZjav-Z.js";const n=l=>(C("data-v-09da561d"),l=l(),T(),l),L={class:"page-container"},S=n(()=>t("view",{class:"bg-elements"},[t("view",{class:"bg-gradient"}),t("view",{class:"bg-circle circle1"}),t("view",{class:"bg-circle circle2"})],-1)),R={class:"content-wrapper"},j=n(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24"},[t("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})],-1)),z=[j],E=n(()=>t("span",{class:"page-title"},"邀请有礼",-1)),H=n(()=>t("view",{class:"placeholder"},null,-1)),V=h('<view class="invite-bg rounded-2xl overflow-hidden relative shadow-lg" data-v-09da561d><view class="absolute left-0 top-0 w-full h-64 bg-gradient" data-v-09da561d></view><view class="bg-decoration right" data-v-09da561d></view><view class="bg-decoration left" data-v-09da561d></view><view class="invite-content" data-v-09da561d><view class="invite-title" data-v-09da561d>邀请好友注册，立获</view><view class="reward-amount" data-v-09da561d><span class="reward-number" data-v-09da561d>300</span><span class="reward-unit" data-v-09da561d>算力</span></view><view class="reward-desc" data-v-09da561d> 等于5分钟时长，有效期30天 </view></view></view>',1),N={class:"reward-stats"},P={class:"reward-total"},U=n(()=>t("view",{class:"reward-icon"},[t("svg",{class:"w-8 h-8 text-blue-500",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5l6.74-6.76zM16 17l-3.54-3.54",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),t("path",{d:"M19.48 10.52c.3.28.48.67.52 1.08",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),A={class:"reward-text"},F={class:"reward-value"},$=n(()=>t("view",{class:"reward-limit"}," 您每月最多可获得3000算力 ",-1)),q={class:"copy-section"},D=n(()=>t("svg",{class:"copy-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M8 5H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-1M8 5a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2M8 5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2m0 0h2a2 2 0 0 1 2 2v3m2 4H10m0 0l3-3m-3 3l3 3",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),W={class:"invite-code"},G={class:"code-value"},J=h('<view class="rules-section" data-v-09da561d><view class="rules-title" data-v-09da561d><svg class="rules-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-09da561d><path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-09da561d></path></svg> 使用说明： </view><view class="rules-content" data-v-09da561d><span class="rule-item" data-v-09da561d>• 复制邀请链接或邀请码给好友，对方通过邀请注册成功后，你即可获得300算力。</span><span class="rule-item" data-v-09da561d>• 如发现违规获取算力的行为，将追回算力或冻结账号。</span><span class="rule-item" data-v-09da561d>• 活动解释权归官方所有。</span></view></view>',1),K={__name:"invite",setup(l){const f=I(),i=v(""),c=v(""),d=v(0),w=()=>{if(!i.value){(e=>{typeof uni<"u"&&typeof uni.showToast=="function"?uni.showToast({title:e,icon:"none"}):(console.error(e),alert(e))})("邀请码获取失败，请刷新页面重试");return}let o="";try{o=window.location.origin+window.location.pathname;const s=window.location.pathname.split("/"),e=s.slice(0,s.length-2).join("/");o=window.location.origin+e,o.endsWith("/")&&(o=o.slice(0,-1))}catch(s){console.error("构建基础URL失败:",s),o=window.location.origin||""}c.value=`${o}?inviteCode=${i.value}`,console.log("生成的邀请链接:",c.value)},_=()=>{c.value||w();const o=e=>{if(typeof uni<"u"&&typeof uni.showToast=="function")uni.showToast(e);else{const a=document.createElement("div");a.textContent=e.title||"",a.style.position="fixed",a.style.top="50%",a.style.left="50%",a.style.transform="translate(-50%, -50%)",a.style.backgroundColor="rgba(0, 0, 0, 0.7)",a.style.color="#fff",a.style.padding="12px 20px",a.style.borderRadius="4px",a.style.fontSize="14px",a.style.zIndex="10000",document.body.appendChild(a),setTimeout(()=>{document.body.removeChild(a)},1500)}};try{navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(c.value).then(()=>{o({title:"邀请链接已复制",icon:"success"})}).catch(e=>{console.error("剪贴板API失败:",e),s()}):s()}catch(e){console.error("复制操作失败:",e),o({title:"复制失败，请手动复制",icon:"none"})}function s(){const e=document.createElement("textarea");e.value=c.value,e.style.position="fixed",e.style.left="-9999px",e.style.top="0",document.body.appendChild(e);try{e.focus(),e.select();const a=document.execCommand("copy");o(a?{title:"邀请链接已复制",icon:"success"}:{title:"复制失败，请手动复制",icon:"none"})}catch(a){console.error("Fallback: 复制到剪贴板失败",a),o({title:"复制失败，请手动复制",icon:"none"})}document.body.removeChild(e)}},g=async()=>{try{const o=localStorage.getItem("userId");if(!o)return;const s=await p.get("/api/invite/total-reward",{params:{userId:o}});s&&s.code===200&&(d.value=s.data||0)}catch(o){d.value=0,console.error("获取累计奖励失败:",o),(e=>{typeof uni<"u"&&typeof uni.showToast=="function"?uni.showToast({title:e,icon:"none"}):console.error(e)})("获取奖励信息失败，请稍后再试")}},m=async()=>{try{const o=await B.getUserInfo();if(o&&o.inviteCode)i.value=o.inviteCode;else{const s=await p.post("/api/user/generate-invite-code");s&&s.code===200&&(i.value=s.data)}w()}catch(o){console.error("获取或生成邀请码失败:",o),(e=>{typeof uni<"u"&&typeof uni.showToast=="function"?uni.showToast({title:e,icon:"none"}):console.error(e)})("获取邀请码失败，请刷新页面或稍后再试")}},y=()=>{f.back()};return k(()=>{m(),g()}),(o,s)=>(M(),x("view",L,[S,t("view",R,[t("view",{class:"nav-bar"},[t("view",{class:"back-button",onClick:y},z),E,H]),V,t("view",N,[t("view",P,[U,t("view",A,[r(" 已累计获得 "),t("span",F,u(d.value),1),r(" 算力 ")])]),$]),t("view",q,[t("button",{class:"copy-button",onClick:_},[D,r(" 复制邀请链接 ")]),t("view",W,[r(" 邀请码: "),t("span",G,u(i.value),1)])]),J])]))}},Y=b(K,[["__scopeId","data-v-09da561d"]]);export{Y as default};
