import{_ as J,a as v,c,b as e,g as p,F as w,e as x,n as m,t as d,j as X,d as j,C as Y,f as q,q as Z,p as ee,k as te,u as se,l as a}from"./index-DDlqzt3H.js";const o=g=>(ee("data-v-b39f4d13"),g=g(),te(),g),oe={class:"video-packaging-container"},le=o(()=>e("view",{class:"bg-gradient"},null,-1)),ce=o(()=>e("view",{class:"bg-grid"},null,-1)),ae=o(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},[e("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z",fill:"#ffffff"})],-1)),ne=[ae],ie=o(()=>e("text",{class:"page-title"},"一键包装",-1)),re={class:"content-wrap"},de={class:"steps-indicator"},ve={class:"step-circle"},_e={class:"step-name"},he={key:0,class:"step-content upload-step"},ue=o(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"48",height:"48"},[e("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z",fill:"rgba(255, 255, 255, 0.7)"})],-1)),pe=o(()=>e("text",{class:"upload-text"},"点击上传视频",-1)),we=o(()=>e("text",{class:"upload-desc"},"支持MP4、MOV、AVI等格式 (最大100MB)",-1)),me=["src"],ge={class:"video-info"},fe={class:"video-name"},xe={class:"video-size"},ye={class:"video-actions"},ke=o(()=>e("text",null,"更换视频",-1)),be=[ke],Ce=o(()=>e("text",null,"下一步",-1)),Fe=[Ce],Se={key:1,class:"step-content style-step"},ze={class:"style-selection"},Be=o(()=>e("text",{class:"style-title"},"选择字幕风格",-1)),Ie=["onClick"],Me=["src"],Le={class:"style-name"},Ve=o(()=>e("text",{class:"style-title"},"选择特效强度",-1)),je={class:"effect-slider"},qe=o(()=>e("text",{class:"slider-label"},"简约",-1)),Ae=o(()=>e("text",{class:"slider-label"},"炫酷",-1)),He=o(()=>e("text",{class:"style-title"},"视频质量",-1)),Te={class:"quality-options"},Ue=["onClick"],Pe={class:"quality-name"},De={class:"quality-desc"},Ne=o(()=>e("text",null,"上一步",-1)),Re=[Ne],Oe=o(()=>e("text",null,"下一步",-1)),$e=[Oe],Ee={key:2,class:"step-content processing-step"},Qe={class:"processing-info"},Ge={class:"processing-circle"},Ke={viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},We=o(()=>e("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#323842","stroke-width":"8"},null,-1)),Je=["stroke-dashoffset"],Xe={class:"progress-text"},Ye={class:"processing-status"},Ze={class:"processing-steps"},et={class:"step-circle"},tt={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16"},st=o(()=>e("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#FFFFFF"},null,-1)),ot=[st],lt={key:1},ct={class:"step-info"},at={class:"step-name"},nt={class:"step-desc"},it={key:3,class:"step-content result-step"},rt={class:"result-info"},dt=Z('<view class="success-icon" data-v-b39f4d13><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="64" height="64" data-v-b39f4d13><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="#00FFAA" data-v-b39f4d13></path></svg></view><text class="result-title" data-v-b39f4d13>视频包装完成!</text><text class="result-desc" data-v-b39f4d13>您的视频已成功添加字幕和特效</text>',3),vt={class:"result-video-container"},_t=["src"],ht=o(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z",fill:"currentColor"})],-1)),ut=o(()=>e("text",null,"下载视频",-1)),pt=[ht,ut],wt=o(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20"},[e("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z",fill:"currentColor"})],-1)),mt=o(()=>e("text",null,"分享视频",-1)),gt=[wt,mt],ft=o(()=>e("text",null,"返回首页",-1)),xt=[ft],yt={__name:"index",setup(g){const S=se(),z=[{name:"上传视频"},{name:"选择风格"},{name:"处理中"},{name:"完成"}],n=v(0),h=v(null),y=v(""),u=v(""),k=v(0),b=v(5),C=v(1),F=v(0),B=v("正在处理您的视频..."),f=v(0),A=[{name:"抖音风格",preview:"https://example.com/douyin-style.jpg"},{name:"科技简约",preview:"https://example.com/tech-style.jpg"},{name:"活力青春",preview:"https://example.com/youth-style.jpg"},{name:"商务专业",preview:"https://example.com/business-style.jpg"},{name:"网红潮流",preview:"https://example.com/influencer-style.jpg"}],I=[{name:"标准清晰度",desc:"480p - 更快处理"},{name:"高清品质",desc:"720p - 推荐"},{name:"超清画质",desc:"1080p - 需更长处理时间"}],H=[{name:"音频提取",desc:"正在从视频中提取音频..."},{name:"语音识别",desc:"正在分析音频内容..."},{name:"文本处理",desc:"正在标记关键词和句子..."},{name:"特效生成",desc:"正在应用动态字幕特效..."},{name:"视频渲染",desc:"正在合成最终视频..."}],M=v(null),T=()=>{S.go(-1)},U=()=>{S.push("/pages/index/index")},L=()=>{M.value.click()},P=t=>{const s=t.target.files[0];if(!s)return;if(!s.type.startsWith("video/")){alert("请选择视频文件");return}if(s.size>100*1024*1024){alert("视频文件不能超过100MB");return}const i=URL.createObjectURL(s);h.value={name:s.name,size:s.size,type:s.type,path:i,file:s},y.value=i},D=t=>{if(t===0)return"0 Bytes";const s=1024,i=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,r)).toFixed(2))+" "+i[r]},N=t=>{k.value=t},R=t=>{b.value=t.detail.value},O=t=>{C.value=t},V=()=>{if(!(n.value===0&&!h.value)){if(n.value===1){G(),n.value=2;return}n.value<z.length-1&&n.value++}},$=()=>{n.value>0&&n.value--},E=()=>{if(u.value){const t=document.createElement("a");t.href=u.value,t.download="视频包装_"+new Date().getTime()+".mp4",document.body.appendChild(t),t.click(),document.body.removeChild(t)}else alert("下载失败，视频URL不存在")},Q=()=>{navigator.share&&u.value?navigator.share({title:"我的网感视频",text:"使用一键包装制作的视频",url:u.value}).then(()=>{console.log("分享成功")}).catch(t=>{console.log("分享失败",t),alert("分享失败，请手动复制链接分享")}):alert("请复制链接分享: "+(u.value||window.location.href))},G=()=>{const t=new FormData;t.append("video",h.value.file),t.append("styleId",k.value),t.append("intensity",b.value),t.append("quality",I[C.value].name),fetch("/tms/api/video-packaging/upload",{method:"POST",body:t}).then(s=>s.json()).then(s=>{s.code===0?K(s.data.taskId):alert("上传失败: "+s.message)}).catch(s=>{console.error("上传错误:",s),alert("网络错误，请重试")})},K=t=>{const s=setInterval(()=>{fetch(`/tms/api/video-packaging/status?taskId=${t}`).then(i=>i.json()).then(i=>{if(i.code===0){const r=i.data;F.value=r.progress,B.value=r.statusText,f.value=r.currentStep,r.status==="completed"?(clearInterval(s),u.value=r.resultVideoUrl,n.value=3):r.status==="failed"&&(clearInterval(s),alert("处理失败: "+r.message))}else clearInterval(s),alert("获取状态失败: "+i.message)}).catch(i=>{console.error("轮询错误:",i),clearInterval(s),alert("网络错误，请重试")})},2e3)};return(t,s)=>{const i=q("scroll-view"),r=q("slider");return a(),c("view",oe,[le,ce,e("view",{class:"page-header"},[e("view",{onClick:T,class:"back-button"},ne),ie]),e("input",{type:"file",ref_key:"fileInput",ref:M,accept:"video/*",style:{display:"none"},onChange:P},null,544),e("view",re,[e("view",de,[(a(),c(w,null,x(z,(_,l)=>e("view",{key:l,class:m(["step",{active:n.value>=l,completed:n.value>l}])},[e("view",ve,d(l+1),1),e("text",_e,d(_.name),1)],2)),64))]),n.value===0?(a(),c("view",he,[e("view",{class:m(["upload-area",{"has-video":h.value}]),onClick:L},[h.value?(a(),c(w,{key:1},[y.value?(a(),c("video",{key:0,class:"video-preview",src:y.value,"object-fit":"contain",controls:""},null,8,me)):p("",!0),e("view",ge,[e("text",fe,d(h.value.name),1),e("text",xe,d(D(h.value.size)),1)]),e("view",ye,[e("view",{class:"action-btn",onClick:X(L,["stop"])},be)])],64)):(a(),c(w,{key:0},[ue,pe,we],64))],2),e("view",{class:m(["next-step-btn",{disabled:!h.value}]),onClick:V},Fe,2)])):p("",!0),n.value===1?(a(),c("view",Se,[e("view",ze,[Be,j(i,{"scroll-x":"",class:"styles-scroll","show-scrollbar":"false"},{default:Y(()=>[(a(),c(w,null,x(A,(_,l)=>e("view",{key:l,class:m(["style-card",{selected:k.value===l}]),onClick:W=>N(l)},[e("image",{class:"style-preview",src:_.preview,mode:"aspectFill"},null,8,Me),e("text",Le,d(_.name),1)],10,Ie)),64))]),_:1}),Ve,e("view",je,[qe,j(r,{class:"slider",min:"1",max:"10",value:b.value,onChange:R,activeColor:"#00FFAA",backgroundColor:"#333","block-color":"#FFFFFF","block-size":"24"},null,8,["value"]),Ae]),He,e("view",Te,[(a(),c(w,null,x(I,(_,l)=>e("view",{key:l,class:m(["quality-option",{selected:C.value===l}]),onClick:W=>O(l)},[e("text",Pe,d(_.name),1),e("text",De,d(_.desc),1)],10,Ue)),64))])]),e("view",{class:"step-actions"},[e("view",{class:"action-btn back-btn",onClick:$},Re),e("view",{class:"action-btn next-btn",onClick:V},$e)])])):p("",!0),n.value===2?(a(),c("view",Ee,[e("view",Qe,[e("view",Ge,[(a(),c("svg",Ke,[We,e("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#00FFAA","stroke-width":"8","stroke-dasharray":"283","stroke-dashoffset":283-283*(F.value/100),transform:"rotate(-90 50 50)"},null,8,Je)])),e("text",Xe,d(F.value)+"%",1)]),e("text",Ye,d(B.value),1),e("view",Ze,[(a(),c(w,null,x(H,(_,l)=>e("view",{key:l,class:m(["processing-step-item",{active:f.value===l,completed:f.value>l}])},[e("view",et,[f.value>l?(a(),c("svg",tt,ot)):(a(),c("text",lt,d(l+1),1))]),e("view",ct,[e("text",at,d(_.name),1),e("text",nt,d(_.desc),1)])],2)),64))])])])):p("",!0),n.value===3?(a(),c("view",it,[e("view",rt,[dt,e("view",vt,[u.value?(a(),c("video",{key:0,class:"result-video",src:u.value,"object-fit":"contain",controls:""},null,8,_t)):p("",!0)]),e("view",{class:"result-actions"},[e("view",{class:"action-btn download-btn",onClick:E},pt),e("view",{class:"action-btn share-btn",onClick:Q},gt)]),e("view",{class:"home-btn",onClick:U},xt)])])):p("",!0)])])}}},bt=J(yt,[["__scopeId","data-v-b39f4d13"]]);export{bt as default};
